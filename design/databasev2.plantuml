@startuml Helpdesk_Simple_ERD

' ============================================
' ERD SEDERHANA UNTUK PRESENTASI
' Dengan penjelasan garis yang jelas
' ============================================

skinparam linetype ortho
skinparam nodesep 100
skinparam ranksep 100
skinparam backgroundColor #FAFAFA
skinparam roundcorner 10
skinparam shadowing false

skinparam entity {
    BackgroundColor #E8F4F8
    BorderColor #0277BD
    BorderThickness 2.5
    FontSize 13
    FontStyle bold
    AttributeFontSize 11
}

skinparam arrow {
    Color #D32F2F
    Thickness 3
}

' ============================================
' LAYER 1: MASTER DATA (Kiri Atas)
' ============================================

package "ğŸ“‹ MASTER DATA" #F5F5F5 {
    entity "roles" as roles {
        **ğŸ”‘ id**
        --
        role_name
        (user, petugas, admin, pimpinan)
    }
    
    entity "users" as users {
        **ğŸ”‘ id**
        --
        ğŸ”— role_id
        nama
        email
        password
        instansi
        **is_available** â† penting!
    }
    
    entity "skills" as skills {
        **ğŸ”‘ id**
        --
        skill_name
        (Web Dev, Network, etc)
    }
    
    entity "user_skills" as user_skills {
        **ğŸ”‘ id**
        --
        ğŸ”— user_id
        ğŸ”— skill_id
        level (expert/advanced/etc)
    }
}

' ============================================
' LAYER 2: KONFIGURASI (Kanan Atas)
' ============================================

package "âš™ï¸ KONFIGURASI" #FFF3E0 {
    entity "sla_config" as sla_config {
        **ğŸ”‘ id**
        --
        sla_name (Express/Standard)
        response_hours
        resolution_hours
    }
    
    entity "service_catalog" as service_catalog {
        **ğŸ”‘ id**
        --
        ğŸ”— required_skill_id
        ğŸ”— sla_id
        nama_layanan
        priority_level
    }
}

' ============================================
' LAYER 3: TICKETING CORE (Tengah)
' ============================================

package "ğŸ« SISTEM TICKETING" #E8F5E9 {
    entity "tickets" as tickets {
        **ğŸ”‘ id**
        ticket_number
        --
        ğŸ”— user_id (pemohon)
        ğŸ”— service_id
        ğŸ”— assigned_to (petugas)
        --
        judul_permohonan
        status
        priority
        response_deadline
        resolution_deadline
    }
}

' ============================================
' LAYER 4: TRACKING (Bawah)
' ============================================

package "ğŸ“Š TRACKING & FEEDBACK" #FCE4EC {
    entity "ticket_logs" as ticket_logs {
        **ğŸ”‘ id**
        --
        ğŸ”— ticket_id
        ğŸ”— action_by
        action_type
        old_value â†’ new_value
    }
    
    entity "feedbacks" as feedbacks {
        **ğŸ”‘ id**
        --
        ğŸ”— ticket_id (unique!)
        ğŸ”— user_id
        rating â­
        review
    }
    
    entity "notifications" as notifications {
        **ğŸ”‘ id**
        --
        ğŸ”— user_id
        ğŸ”— ticket_id
        type
        message
        is_read
    }
}

' ============================================
' RELASI - DENGAN LABEL JELAS
' ============================================

' Master Data Relations
roles ||--o{ users : "1 role â†’ banyak user"
note on link
  Contoh:
  Role "petugas" dimiliki
  oleh Andi, Budi, Candra
end note

users ||--o{ tickets : "1 petugas (assigned_to)\nâ†’ bisa kerja banyak tiket"
note on link #FFCCBC
  **RELASI PETUGAS**
  Mas Andi lagi
  kerja 5 tiket
end note

' Tracking Relations
tickets ||--o{ ticket_logs : "1 tiket â†’ punya banyak log aktivitas"
note on link #F0F4C3
  **AUDIT TRAIL**
  Semua perubahan dicatat:
  â€¢ Siapa yang ubah
  â€¢ Kapan diubah
  â€¢ Dari apa ke apa
end note

users ||--o{ ticket_logs : "1 user â†’ bisa melakukan banyak aksi"

tickets ||--|| feedbacks : "1 tiket = TEPAT 1 feedback"
note on link #E1BEE7
  **ATURAN KETAT**
  1 tiket hanya boleh
  1 feedback, tidak boleh lebih!
end note

users ||--o{ feedbacks : "1 user â†’ bisa kasih banyak feedback\n(untuk tiket berbeda)"

users ||--o{ notifications : "1 user â†’ terima banyak notifikasi"
tickets ||--o{ notifications : "1 tiket â†’ generate banyak notifikasi"

' ============================================
' LEGENDS & NOTES
' ============================================

legend top left
  **PANDUAN MEMBACA DIAGRAM**
  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  
  **Simbol:**
  ğŸ”‘ = Primary Key (Kunci Utama)
  ğŸ”— = Foreign Key (Kunci Asing/Relasi)
  
  **Garis Relasi:**
  <b>||</b>  = Tepat SATU (exactly one)
  <b>|o</b>  = Nol atau SATU (zero or one)
  <b>o{</b>  = Nol atau BANYAK (zero or many)
  <b>|{</b>  = Satu atau BANYAK (one or many)
  
  **Contoh Membaca:**
  roles <b>||--o{</b> users
  Artinya: 1 role bisa dimiliki 0 atau banyak user
  
  users <b>||--o{</b> tickets
  Artinya: 1 user bisa membuat 0 atau banyak tiket
  
  tickets <b>||--||</b> feedbacks
  Artinya: 1 tiket = tepat 1 feedback (tidak lebih!)
end legend

note top of tickets #FFE082
  **TABEL PALING PENTING! ğŸ«**
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Ini adalah JANTUNG sistem
  
  **Field Krusial:**
  â€¢ user_id â†’ Siapa pemohon?
  â€¢ assigned_to â†’ Petugas siapa?
  â€¢ service_id â†’ Layanan apa?
  â€¢ status â†’ Statusnya apa?
  â€¢ deadline â†’ Kapan harus selesai?
  
  **Alur Status:**
  pending â†’ assigned â†’ in_progress
  â†’ completed â†’ closed
end note

note bottom of users #B2DFDB
  **Field is_available:**
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  â€¢ true = Petugas kosong
  â€¢ false = Sedang kerja
  
  Dipakai untuk AUTO-ASSIGN
  tiket ke petugas yang lagi
  kosong!
end note

note right of sla_config #FFCCBC
  **SLA = Service Level Agreement**
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  Jaminan waktu pengerjaan:
  
  Express: 2 jam respon, 8 jam selesai
  Standard: 4 jam respon, 24 jam selesai
  Extended: 8 jam respon, 72 jam selesai
end note

' ============================================
' FLOW EXPLANATION
' ============================================

note bottom of service_catalog
  **ALUR AUTO-ASSIGN:**
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  1. User pilih layanan
     (dari service_catalog)
  2. Sistem cek: layanan ini
     butuh skill apa?
  3. Cari petugas yang punya
     skill itu & lagi kosong
     (is_available = true)
  4. Assign tiket ke petugas
end note

@enduml--o{ user_skills : "1 user â†’ banyak skill"
skills ||--o{ user_skills : "1 skill â†’ dimiliki banyak user"

note right of user_skills
  **Tabel Penghubung**
  Many-to-Many antara
  users dan skills
  
  Contoh:
  â€¢ Andi: Web Dev (expert)
  â€¢ Andi: Database (intermediate)
end note

' Service Configuration
skills ||--o{ service_catalog : "1 skill â†’ butuh di banyak layanan"
note on link #FFE082
  Contoh:
  Skill "Web Dev" dipakai
  untuk layanan:
  â€¢ Perbaikan Website
  â€¢ Install CMS
  â€¢ Update Konten
end note

sla_config ||--o{ service_catalog : "1 SLA â†’ untuk banyak layanan"

' Ticketing Relations
users ||--o{ tickets : "1 user (pemohon)\nâ†’ bisa buat banyak tiket"
note on link #B2DFDB
  **RELASI PEMOHON**
  Pak Budi bisa buat
  10 tiket berbeda
end note

service_catalog ||--o{ tickets : "1 layanan â†’ diminta di banyak tiket"

users || 

@enduml